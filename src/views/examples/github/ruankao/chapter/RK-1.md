# 计算机基础、体系、3性基础

计算机系统基础知识、计算机体系结构以及安全性、可靠性、系统性能性能评测基础


## 计算机系统基础知识
### 1、CPU组成
- 运算器
    - 算术逻辑单元 ALU
    - 累加寄存器 AC
    - 数据缓冲寄存器 DR
    - 状态条件寄存器 PSW

- 控制器
    - 程序计数器 PC
    - 指令寄存器 IR
    - 指令译码器
    - 时序部件


### 2、数据的表示

- 二机制与十进制互转

    - 二进制转十进制（按权展开法）

      对10进制，从低位到高位，依次要乘以10<sup>0</sup>，10<sup>1</sup>，10<sup>2</sup>，10<sup>3</sup>等； 也就是 1，10，100，1000

      对2进制，从低位到高位，依次要乘以2<sup>0</sup>，2<sup>1</sup>，2<sup>2</sup>，2<sup>3</sup>等； 也就是 1，2，4，8

      如果有小数点，小数点后就为 2<sup>-1</sup>，2<sup>-2</sup>，2<sup>-3</sup>，2<sup>-4</sup>等；也就是 0.5，0.25，0.125，0.625

      示例：
      
      11011 = **1x2<sup>4</sup> + 1x2<sup>3</sup> + 0x2<sup>2</sup> + 1x2<sup>1</sup> + 1x2<sup>0</sup>** = **16 + 8 + 0 + 2 + 1** = 27
      
      0.0001 = **0x2<sup>0</sup> + 0x2<sup>-1</sup> + 0x<sup>-2</sup> + 0x<sup>-3</sup> + 1x<sup>-4</sup>** = **0 + 0 + 0 + 0 + 0.0625** = 0.0625

<!-- <br> -->

- 十进制转二进制
    - 整数

      用2整除十进制整数，可以得到一个商和余数；再用2去除商，又会得到一个商和余数，一直求解，直到商小于1时为止；然后从后往前将余数排序，得出 2进制；

      `53` = **从下往上排序** = `110101`

      十进制 | 商 | 余数
      ---   | --- | ---
      53 / 2| 26  | 1
      26 / 2| 13  | 0
      13 / 2| 6   | 1
      6  / 2| 3   | 0
      3  / 2| 1   | 1
      1  / 2| 0   | 1

    - 小数

      用2乘以十进制小数，可以得到一个积和整数；再用2乘以积，又会得到一个积和整数，一直求解，直到积等于0或1为止；然后从前往后将整数排序，得出 2进制；

      `0.0625` = **从上往下排序** = `0001`

      十进制     | 积    | 取整
      ---       | ---   | ---
      0.0625 * 2| 0.125 | 0
      0.125  * 2| 0.25  | 0
      0.25   * 2| 0.5   | 0
      0.5    * 2| 1     | 1


### 3、原码，反码，补码，移码

码制 | 定点整数
---  | ---     
原码 | -(2<sup>n-1</sup> - 1) ~ (2<sup>n-1</sup> - 1)
反码 | -(2<sup>n-1</sup> - 1) ~ (2<sup>n-1</sup> - 1)
补码 | -2<sup>n-1</sup> ~ (2<sup>n-1</sup> - 1)
移码 | -2<sup>n-1</sup> ~ (2<sup>n-1</sup> - 1)


### 4、浮点数运算

一个数的浮点表示不是唯一的。当小数点的位置改变时、阶码也随着改变。因此可以用多个浮点形式来表示同一个数

浮点数表示：
**N = M * R<sup>e<sup>**

其中M为尾数，R为基数，e是指数

运算顺序：`对阶` --> `尾数计算` --> `结果格式化`

注意要点：

- 对阶：由小阶向大阶看齐

- 结果格式化：小数点左边 不能为0 并且 只能为1位数


## 计算机体系结构分类

### 1、指令流 or 数据流

体系结构 | 结构 | 特性 | 代表
---| --- | --- | ---
单指令流单数据流 SISD| 控制部分、处理器、主存模块都是单个 ||单片机
单指令流多数据流 SIMD| 控制部分为单、其余为多|多个处理器执行同一条指令| 阵列处理机
多指令流单数据流 MISD| 处理器为单、其余为多|理论阶段|
多指令流多数据流 MIMD| 全为多|任务、指令并行操作| 多处理机系统、多计算机

### 2、 CISC or RISC

指令系统类型 | 指令 | 寻址方式 | 实现方式 | 其它
--- | --- | --- | --- |---
CISC(复杂) | 数量多、使用频率差别大，可变长格式| 支持多种 | 微程序控制技术 | 研制周期长
RISC(精简) | 数量少、使用频率接近，定长格式，大部分为单周期指令，操作寄存器，只有Load/Store操作内存| 支持方式少 | 增加通用寄存器，硬布线逻辑控制为主 | 支持高级语言

### 3、流水线 - 概念

指在程序执行时多条指令重叠进行操作的一种准并行处理实现技术。各种部件同时处理针对不同指令而言的，它们可同时为多条指令的不同部分进行工作，以提高各部件的利用率和指令的平均执行速度

`取指` > `分析` > `执行`

### 4、流水线 - 计算  

流水线周期为执行时间最长的一段

计算公式：1条指令执行时间 + (指令条数 - 1) * 流水线周期
- **优先使用** 理论公式：**(t1 + t2 + .. + tk) + (n-1) * △T**
- 实践公式：**(k + n - 1) * △T**

> t1/t2/tk = 取指时间/分析时间/执行时间<br>
> n        = 指令条数<br>
> △T      = 流水线周期<br>
> k        = 一条指令分为几部分<br>

例：若指令流水线把一条指令分为取指、分析和执行三部分，且三部分时间分别是取指3ns, 分析3ns，执行2ns；那么流水线周期是多少？100条指令全部执行完毕需要的时间是多少？

答：

1. 流水线周期为 3ns

2. 执行完毕时间为
  
    理论公式：(3 + 3 + 2) + (100 - 1) * 3 = 305

    实践公式：(3 + 100 - 1) * 3 = 306

### 5、流水线 - 吞吐率计算

1. 吞吐率计算

    **TP = 指令条数 / 流水线执行时间**

2. 流水线最大吞吐率

    **TP<sub>max</sub> = 1 / 流水线周期时间**

### 6、流水线 - 流水线的加速比

- 加速比公式：**S = 不使用流水线执行时间 / 使用流水线执行时间**

    以第 4 条中的示例为准，计算加速比

    S  = ((3 + 3 + 2) * 100) / 305 = 800 / 305

### 7、流水线 - 效率

流水线的效率是指流水线的设备利用率

- 效率公式：**E = n个任务占用的时空区 / k个流水段的总的时空区**

### 8、层次化存储结构

`CPU(寄存器)` > `Cache(按内容存取)` > `内存` > `外存(硬盘、U盘等)`

### 9、Cache - 概念

- 提高CPU数据输入输出的速率、即CPU与存储系统间数据传送带宽限制
- 在计算机的存储系统体系中，Cache是访问速度最快的层次
- 使用Cache改善系统性能的依据是程序的局部性原理

例：计算 Cache + 内存 的系统的平均周期t<sub>3</sub>是多少
？

答：

**t<sub>3</sub> = h * t<sub>1</sub> + (1 - h) * t<sub>2</sub>**

> t<sub>1</sub> = Cache的周期时间<br>
> t<sub>2</sub> = 内存的周期时间<br>
> h = 访问命中率(即 CPU 直接可以在Cache中寻找到目标源的概率)<br>
> (1 - h) = 失效率(即 CPU 直接可以在Cache中寻找到目标源的失败概率)

### 10、局部性原理

将 重复性工作、放入Cache中提高效率

- 时间局部性
- 空间局部性
- 工作集理论： 工作集是进程运行时被频繁访问的页面集合

### 11、主存

- 随机存取存储器(RAM)
- 只读存储器(ROM)


### 12、磁盘结构/参数

存取时间 = 寻道时间 + 等待时间(平均定位时间 + 转动延迟)

寻道时间：磁头移动到磁道所需的时间

等待时间：等待读写读写的扇区转到磁头下方所用的时间


单缓冲区顺序处理：一次只能处理一条

信息存储优化分布：将执行顺序 和 执行时间 合理排序

- 单缓冲区计算：

  S<sub>max</sub> = (Rm + t) * (h - 1) + (Rs + t)  

- 信息存储优化计算：

  S<sub>min</min> = t * h * 2 


> S<sub>max</sub> = 最长时间<br>
> Rm = 磁盘旋转周期<br>
> t = 单缓存区处理时间<br>
> h = 磁盘扇区长度<br>
> Rs = 最后一个磁盘扇区<br>
> S<sub>min</sub> = 最长时间<br>
> 2 = 只针对单缓冲区时间 与 单个扇区时间(Rm / h)相等的情况下

### 13、总线

- 内部总线

- 系统总线

  - 数据总线
  - 地址总线
  - 控制总线

- 外部总线

### 14、校验码

- 什么是检错和纠错？

  检错：检测出来错误

  纠错：检测出错误并修复错误

- 什么是码距？
  
  整个编码系统中任意两个码字的最小距离

### 15、 循环校验码CRC - 检错编码

- 模2除法

### 16、海明校验码 - 检错/纠错

- 2<sup>r</sup> >= 4 + r + 1

## 3性基础

### 1、 串联系统与并联系统

- 串联系统
  - 任何一个环节出现错误、则全部错误

可靠度：R = R<sub>1</sub> * R<sub>2</sub> * ... * R<sub>n</sub>

失效率(并不完全准确)：λ = λ<sub>1</sub> + λ<sub>2</sub> + ... + λ<sub>n</sub>

- 并联系统
  - 只有所有环节错误时、才会全部错误

可靠度：R = 1 - (1 - R<sub>1</sub>) * (1 - R<sub>2</sub>) * ... * (R<sub>n</sub>)

失效率：λ = 1 - R

### 2、N模冗余系统与混合系统

- N模冗余系统
  - N个子系统占多数相同结果的输出作为系统的输出

- 混合系统

可靠度：R = 并联的可靠度 * 串联可靠度